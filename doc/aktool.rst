Утилита aktool: правила пользования
===================================

`aktool` - консольная утилита, предназначенная для криптографической защиты данных в пространстве пользователя.

Утилита предоставляет интерфейс к различным криптографическим
преобразованиям таким, как шифрование и контроль целостности данных,
выработка и проверка электронной подписи, генерация криптографических
ключей и паролей, создание и верификация сертификатов открытых ключей.

Описание
--------

Синтаксис выполнения программы::

  aktool команда [опции] [файл или каталог]

Каждая команда определяет отдельный класс криптографических
преобразований и функциональных возможностей. В настоящее время
доступны следующие команды.

=============  ============ =========
Краткая форма  Полная форма Описание
=============  ============ =========
a              asn1parse    Декодирование и печать ASN.1 данных
e              encrypt      Зашифрование данных пользователя
d              decrypt      Расшифрование данных пользователя
i              icode        Вычисление контрольной суммы или имитовставки
k              key          Управление ключевой информацией
s              show         Вывод служебной и справочной информации
t              test         Тестирование корректности и скорости работы криптограграфических механизмов
=============  ============ =========

Получить информацию о доступных опциях и параметрах любой
команды можно с помощью вызова::

  aktool команда --help

Получить информацию о текущей версии утилиты и компиляторе, которым она была собрана,
можно с помощью вызова::

  aktool --version


Управление ключевой информацией
-------------------------------

Команда `key` (короткая форма `k`) позволяет вырабатывать секретные и открытые ключи
для дальнейшего использования в алгоритмах шифрования, контроля целостности,
процедурах выработки и проверки электронной подписи и т.п.

Поддерживается инфраструктура сертификатов открытых ключей, а также
генерация ключей парной связи (симметричных ключей)
в соответствиии со схемой Блома распределения ключевой информации.

Команда `key` позволяет сохранять секретные ключи в файлы или
ключевое хранилище в контейнере, формат которого является открытым
и распространяется вместе с документацией к библиотеке `libakrypt`.
Перед сохранением секретного ключа пользователю предлагается
ввести пароль, используемый для шифрования созданного секретного ключа.
Ввод пароля можно осуществлять как в символьном, так и в шестнацатеричном формате.

Вырабатываемые открытые ключи могут сохраняться как в формате запроса на сертификат,
так и в формате собственно сертификата в соответствии с рекомендациями
Р 1323565.1.23-2018. Также команда `key` позволяет просматривать и
изменять параметры созданных ранее ключей.


Опции команды key
~~~~~~~~~~~~~~~~~

.. option:: -a, --algorithm=метод

Опция позволяет определить метод или алгоритм, используемый для генерации ключевой
информации. Для этого необходимо указать его имя или идентификатор.
Опция необходима в некоторых схемах выработки ключей, например, при использовании `схемы Блома <aktool.html#id6>`__.

.. option:: --ca-cert=файл

Опция позволяет указать имя файла, содержащего сертификат открытого ключа центра сертификации.
Опция может использоваться для выработки и верификации пользовательских сертификатов.

.. option:: --ca-key=файл

Опция позволяет указать имя файла, содержащего секретный ключ центра сертификации.
Опция может применяться при генерации пользовательских сертификатов из запросов на сертификат.
Данная опция является другой формой опции :option:`--key`.

.. option:: --curve=имя

Опция позволяет указать имя или идентификатор эллиптической кривой,
которой принадлежит открытый ключ.

.. option:: --days=число

Опция позволяет определить срок действия секретного или открытого ключа.
Срок исчисляется заданным количеством дней, начиная с момента вызова утилиты.

.. option:: --field=[ 256, 512 ]

Опция позволяет указать `n` - степень расширения конечного поля :math:`\mathbb F_{2^n}`, используемого для реализации
криптографических алгоритмов. Допустимыми аргументами опции являются значения 256 или 512 бит.

.. option:: --format=[ der, pem, certificate ]

Опция позволяет указать формат хранения вырабатываемого файла с ключевой информацией.
Допустимыми аргументами опции являются значения `der`, `pem` или `certificate`.

.. option:: --id=строка

Опция позволяет определить имя или идентификатор владельца ключа.

В случае использования данной опции одовременно с созданием сертификата открытого ключа или запроса на сертификат
значение `строка` определяет расширенное имя владельца.
Расширенное имя владельца должно состоять из последовательности секций вида
`/секция1=значение/секция2=значение2`,
где название секции должно принимать значение из множества:

    * `em` (электронная почта), `cn` (основное имя), `ct` (страна), `st` (область), `lt` (поселение), `sa` (улица), `or` (организация), `ou` (отдел), `tl` (должность), `su` (фамилия), `gn` (имя), `ps` (псевдоним) и `sn` (серийный номер).

Также поддерживаются названия секций, рекомендованные для использования в Российской Федерации:

    * `og` (ОГРН), `oi` (ОГРНИП), `si` (СНИЛС), `in` (ИНН физического лица) и `le` (ИНН юридического лица).

В случае создания сертификатов или запросов на сертификат открытого ключа
допускается использование опции  без указания имени секции. В этом случае
переданная строка определяет основное имя владельца ключа.

.. option:: --id-hex=строка

Опция позволяет указать имя владельца секретного ключа в виде шестнадцатеричной последовательности.
Данная опция не применяется при выработке сертификатов или запросов на сертификат открытого ключа.

.. option:: --inpass=строка

Опция позволяет указать пароль доступа к считываемому секретному ключу в командной строке.
Использование данной опции может привести к компрометации ключевой информации.

.. option:: --inpass-hex=строка

Опция позволяет указать пароль доступа к считываемому секретному ключу в командной строке
в виде шестнадцатеричной последовательности.
Использование данной опции может привести к компрометации ключевой информации.

.. option:: --key=файл

Опция позволяет указать имя файла, содержащего считываемый секретный ключ
симметричного или асимметричного алгоритма.

.. option:: --label=строка

Опция позволяет присвоить секретному ключу пользовательскую метку или описание.

.. option:: -n, --new

Опция создает новый секретный ключ или ключевую пару для заданного криптографичеспкого алгоритма.

.. option:: --no-outpass

Опция позволяет не указывать пароль доступа к контейнеру создаваемого секретного ключа.
В этом случае ключ помещается в контейнер в незашифрованном виде, что является потенциально небезопасным.

.. option:: --op

Короткая форма опции :option:`--output-public-key`.

.. option:: --outpass=строка

Опция позволяет указать пароль доступа к созданному секретному ключу прямо в командной строке.
Использование данной опции не является безопасным и может привести к компрометации ключевой ифнормации.

.. option:: --outpass-hex=строка

Опция позволяет указать пароль доступа к созданному секретному ключу прямо в командной строке
в виде шестнадцатеричной последовательности.
Использование данной опции не является безопасным и может привести к компрометации ключевой ифнормации.

.. option:: --output-public-key=файл

Опция позволяет указать имя файла, в котором будет сохранен созданный сертификат или
запрос на сертификат открытого ключа. Имеет короткую форму :option:`--op`.

.. option:: -o, --output-secret-key=файл

Опция позволяет указать имя файла, в котором будет сохранен созданный секретный ключ.

.. option:: --p7b-create

Опция позволяет поместить один или несколько сертификатов центра сертификации в один контейнер
в формате PKCS #7 (обычно используется расширение `p7b`).
Помещаемые в контенер сертифкаты указываются в качестве последних аргументов командной строки.

.. option:: --p7b-ls=файл

Опция позволяет вывести в консоль список сертификатов,
хранящихся в PKCS #7 контейнере.

.. option:: --p7b-split=файл

Опция позволяет извлечь из контейнера в формате PKCS #7
все доступные сертификаты и сохранить их в виде отдельных файлов (в кодировке `der` или `pem`).

.. option:: --random=имя

Опция позволяет указать имя или идентификатор генератора псевдослучайных последовательностей,
используемого для выработки ключевой информации или электронной подписи.
По умолчанию устанавливается генератор, зависящий от операционной системы, в которой выполняется утилита.
В `Unix`-системах это генератор, доступ к которому обеспечивается символьным устройством `/dev/random`.

.. option:: --random-file=файл

Опция позволяет в явном виде указать имя файла из которого происходит чтение псевдослучайных последовательностей.
Использование данной опции целесообразно для доступа к физическим генераторам, предоставляющим доступ к вырабатываемым
данным посредством символьных устройств.

.. option:: --repo=каталог

Опция указывает путь к хранилищу доверенных сертификатов.
Если опция не указана, используется установленный по-умолчанию каталог
(в Unix-системах это может быть `/usr/share/ca-certificates/libakrypt`.
Может использоваться совместно с
опциями: :option:`--repo-add`, :option:`--repo-check`, :option:`--repo-ls` и :option:`--repo-rm`.

.. option:: --repo-add=файл

Опция добавляет сертификат в хранилище доверенных сертификатов.
В качестве аргумента опции может выступать как `файл` с сертификатом ключа (в `pem` или `der`-кодировке),
так и контейнер сертификатов в формате PKCS #7 (обычно используется расширение `p7b`).
Для записи могут потребоваться права доступа к хранилищу.

.. option:: --repo-check

Опция проверяет валидность всех сертификатов, содержащихся в хранилище доверенных сертификатов.
При необходимости, функция приводит имена и форматы хранения сертификатов к единому виду: ``серийный_номер.cer``,
а также удаляет из хранилища лишние файлы и невалидные сертификаты.
Для удаления данных могут потребоваться права доступа к хранилищу.

.. option:: --repo-ls

Опция выводит список доверенных сертификатов, находящихся
в ключевом хранилище.

.. option:: --repo-rm=срока

Опция удаляет из хранилища доверенных сертификатов те сертификаты,
в серийных номерах которых содержится указанная `строка`.
Длина строки должна быть не менее 6 символов.

.. option:: --secret-key-number=строка

Опция позволяет указать в явном виде номер секретного ключа (как строку, состоящую не более чем из 64 шестнадцатеричных символов).
Данный номер может быть использован при создании новых секретных ключей, а также при
создании сертификатов открытых ключей с расширением, задаваемым опцией :option:`--key-encipherment`.

.. option:: --show=файл

Опция позволяет вывести в простом текстовом формате
значения параметров секретного ключа (симметричного или асимметричного).

.. option:: --show-algorithm=файл

Опция позволяет вывести идентификатор алгоритма, для которого предназначен секретный ключ.

.. option:: --show-curve=файл

Опция позволяет вывести идентификатор эллиптической кривой, которой принадлежит
открытый ключ, соответствующий указанному секретному ключу. Результат определен только для
секретных ключей асимметричных алгоритмов.

.. option:: --show-label=файл

Опция позволяет вывести метку секретного ключа.

.. option:: --show-number=файл

Опция позволяет вывести уникальный номер секретного ключа.

.. option:: --show-public-key=файл

Опция позволяет вывести уникальный номер открытого ключа,
соответствующего указанному секретному ключу. Результат определен только для
секретных ключей асимметричных алгоритмов.

.. option:: --show-resource=файл

Опция позволяет вывести оставшийся ресурс секретного ключа.

.. option:: -s, --sign файл(ы)

Опция подписывает созданный ранее запрос на сертификат открытого ключа и создает сертификат.
В качестве аргумента опции может выступать одно или несколько имен файлов,
содержащих запросы на сертификат. Также допускается использование шаблонов, например, `*.csr`.
В случае нескольких запросов они все будут подписаны одним и тем же ключом центра сертификации.

.. option:: --size=[ 1, .., 4096 ]

Опция позволяет указать размер ключевого множества для создаваемого секретного ключа, например, в `схеме Блома <aktool.html#id6>`__.
Максимально допустимым значением в настоящее время является величина 4096.

.. option:: -t, --target=имя

Опция позволяет указать имя криптографического алгоритма для которого предназначается создаваемый секретный ключ.
Для генерации простой незашифрованной последовательности заданного размера, не связанной ни с каким криптографическим алгоритмом,
в качестве имени алгоритма должна быть указана строка `undefined`.

.. option:: --to

Короткая форма опции :option:`--format`.

.. option:: -v, --verify=файл

Опция выполняет верификацию открытого ключа,
который может быть задан в виде сертификата, запроса на сертификат открытого ключа или контейнера сертификатов
в формате PKCS #7 (обычно используется расширение `p7b`).
В качестве параметров опции может быть указан один или несколько файлов, а также шаблон, например, `*.crt`.
Если указана опция :option:`--verbose`, то утилита выводит значение открытого ключа в консоль.


Управление расширениями сертификатов открытых ключей
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Далее указаны опции, которые могут быть использованы для управления расширениями сертификатов открытых ключей.

.. option:: --authority-name

Опция добавляет в расширение ``AuthorityKeyIdentifier`` расширенное имя центра сертификации.
По умолчанию данная возможность отключена.

.. option:: --ca

Опция объединяет в себе вызов двух опций: :option:`--ca-ext` = ``true`` и :option:`--key-cert-sign`.
Должна использоваться при создании сертифката открытого ключа центра сертификации.

.. option:: --ca-ext=[ true, false ]

Опция позволяет указать, может ли создаваемый сертификат открытого ключа
являться сертификатом центра сертификации.
Допустимыми значениями опции являются значения `true` или `false`.

.. option:: --pathlen=число

Опция устанавливает максимальную длину цепочки сертификации.
Имеет смысл только одновремено со значением :option:`--ca-ext` = ``true``.

.. option:: --digital-signature

Опция разрешает использование открытого ключа для проверки электронной подписи под пользовательскими данными
(в расширение ``KeyUsage`` добавляется бит ``Digital Signature``)

.. option:: --key-encipherment

Опция разрешает использование открытого ключа для зашифрования ключевой информации
(в расширение ``KeyUsage`` добавляется бит ``Key Encipherment``)

.. option::  --data-encipherment

Опция разрешает использование открытого ключа для зашифрования пользовательских данных
(в расширение ``KeyUsage`` добавляется бит ``Data Encipherment``)

.. option:: --key-agreement

Опция разрешает использование открытого ключа в протоколах выработки ключевой информации
(в расширение ``KeyUsage`` добавляется бит ``BKey Agreement``)

.. option:: --key-cert-sign

Опция разрешает использование открытого ключа для проверки подписи под сертификатами открытых ключей
(соответствующий секретный ключ может быть использован для выработки подписи под сертификатами открытых ключей)
(в расширение ``KeyUsage`` добавляется бит ``Certificate Sign``)

.. option::  --crl-sign

Опция разрешает использование открытого ключа для проверки подписи под списками отозванных сертификатов
(в расширение ``KeyUsage`` добавляется бит ``CRL Sign``)


Примеры выработки ключей симметричных криптографических алгоритмов
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Создать секретный ключ алгоритма блочного шифрования "Магма" можно с помощью следующей команды::

  aktool k -nt magma -o magma.key

В процессе выполнения указанной команды пользователю будет предложено ввести пароль доступа,
на котором будет зашифрованно значение созданного ключа. С использованием опции :option:`--outpass`
можно определить пароль доступа к созданному ключу прямо в командной строке.

Аналогично, создание нового секретного ключа выработки имитовставки для алгоритма HMAC,
основанного на использовании функции хеширования "Стрибог256",
можно выполнить с помощью следующего вызова::

  aktool k -nt hmac-streebog256 -o secret-hmac256.key \\
     --label "used for testing purpose" --random-file /dev/random

При этом, значение создаваемого ключа считывается из файла `/dev/random`,
предоставляющего в `Unix`-системах доступ к биологическому генератору случайных чисел, см. [P1323565.1.012-2017]_, раздел 3.4.
Опция программы :option:`--label` задает метку ключа ``used for testing purpose``,
а сам ключ будет сохранен в файл `secret-hmac256.key`.

Посмотреть информацию о созданном ключе можно с помощью одного из следующих вызовов::

  aktool k -s secret-hmac256.key
  aktool a secret-hmac256.key

В первом случае будет выведена информация о параметрах созданного ключа в виде простой таблицы следующего вида::

  Тип:
    Симметричный секретный ключ
  Алгоритм:
    hmac function (hmac-streebog256, 1.2.643.7.1.1.4.1)
  Номер:
    64fd34212dad3aa2d6e3c1646237b0ab6a167833aa018aa251f6b6b9b6328a2c
  Ресурс: 65536 (key usage resource)
    от: 25 янв 2022 23:03:51 (Понедельник) MSK
    до: 25 янв 2023 23:03:51 (Вторник) MSK
  Метка:
    used for testing purpose

Во втором случае будет выведена ASN.1 структура, содержащая, в частности,
зашифрованное значение созданного ключа.


Примеры выработки ключевых пар и сертификатов открытых ключей
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Выработка ключевой пары должна производиться с явным указаним алгоритма электронной подписи.
Например, ключевая пара для алгоритма ГОСТ Р 34.10-2012 может быть выработана
с помощью следующего вызова::

  aktool k -nt sign256 -o aktool256.key --op aktool256_request.csr --to pem

В процессе создания ключей будет запрошена и помещена в запрос на сертификат открытого ключа
информация о владельце создаваемого ключа. Созданый запрос будет сохранен в формате `pem`
(текстовый файл, содержащий двоичную последовательность в кодировке `base64`).
Посмотреть содержимое созданных ключей можно следующим образом::

  aktool k --show aktool256.key
  aktool k -v aktool256_request.csr --verbose

Для явного определения эллиптической кривой, которой принадлежит создаваемый открытый ключ,
необходимо воспользоваться опцией :option:`--curve`.
Для явного указания информации о владельце ключа необходимо воспользоваться опцией :option:`--id`.

В следующем примере создается ключевая пара и открытый ключ помещается в самоподписаный сертификат.
Синтаксис команды отличается от предыдущего только явным указанием эллиптической кривой и
аргументом опции :option:`--to`::

  aktool k -nt sign512 --curve ec512b -o aktool512.key --op aktool512_ca.crt \\
     --to certificate --id "/cn=Aktool CA Team"

Для подписи созданного ранее запроса на сертификат можно воспользоваться следующей командой::

  aktool k -s aktool256_request.csr --ca-key aktool512.key \\
     --ca-cert aktool512_ca.crt --op aktool256_certificate.crt --to pem

Для верификации и просмотра созданных сертификатов можно воспользоваться следующими командами::

  aktool k -v aktool256_request.csr --verbose
  aktool k -v aktool256_certificate.crt --ca-cert aktool512_ca.crt --verbose

Отметим, что во втором примере в явном виде указывается сертификат открытого ключа удостоверяющего центра,
используемый для проверки подписи под сертификатом пользователя.

Следующая команда помещает сертификат в хранилище
доверенных сертификатов (при помещении сертификата проверяется его валидность).
Это позволит функциям библиотеки находить
открытый ключ без дополнительных указаний со стороны пользователя::

  aktool k --repo-add aktool512_ca.crt

В качестве примеров для работы с контейнерами сертификатов в формате PKCS #7 (обычно используется расширение `p7b`),
могут быть использованы следующие команды::

  aktool k --p7b-create ca*.cer --op cacer.p7b --to pem
  aktool k --p7b-ls cacer.p7b
  aktool k -v cacer.p7b
  aktool k --repo-add cacer.p7b

В первом примере утилита помещает все валидные сертфикаты, имена которых удовлетворяют
шаблону поиска ``ca*.cer``, в контейнер с заданным именем `cacer.p7b`
в текстовом формате (с использованием кодировки `base64`).
Далее, содержимое контейнера выводится в консоль, верифицируется и добавляется в хранидище доверенных сертификатов.

Добавим, что в состав исходных текстов библиотеки входит набор тестовых скриптов
(каталог `scripts`), содержащий большое количество примеров использования утилиты `aktool`
для выработки и верификации сертификатов открытых ключей.


Примеры выработки ключевой информации в схеме Блома
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Для генерации ключей парной связи (общих симметричных ключей) в схеме Блома [BLOM82]_ необходимо
выполнить последовательность из трех шагов:

   * выработать мастер-ключ,
   * выработать ключ пользователя c заданным идентификатором, например, ``IDa``,
   * выработать ключ парной связи абонента ``IDa`` с другим абонентом, обладающим заданным идентификатором, например, ``IDb``.

Опишем перечисленые шаги более подробно.

На первом шаге необходимо выработать мастер-ключ, представляющий собой квадратную матрицу из элементов конечного
поля :math:`\mathbb F_{2^n}` для `n` равного 256 или 512 бит.
Выработать мастер-ключ можно с помощью следующего вызова, явно указав
имя алгоритма генерации ключей: `blom-master` или `blom-matrix`::

  aktool k -na blom-master --size 640 --field 256 -o master.key

В процессе выполнения указанной команды пользователю будет предложено ввести пароль доступа,
на котором будут зашифрованы вырабатываемые ключевые значения.
Определить используемый генератор случайных чисел можно с помощью опций :option:`--random` или :option:`--random-file`.

В приведенном примере размер вырабатываемой матрицы составляет 640x640 элементов.
Матрица сохраняется в файл `master.key` (cледует заметить,
что размер вырабатываемого мастер-ключа должен
составлять 32 + `size` x (`size` + 1 ) x `field` / 16 октетов
и для приведенного примера будет составлять `6563872` октетов).

На втором шаге, для выработки ключа абонента с идентификатором ``IDa``, необходимо выполнить следующую команду,
явно указав имя алгоритма генерации ключей: `blom-user`::

  aktool k -na blom-user --key master.key -o IDa.key --id IDa

Выработанный ключ будет помещен в файл `IDa.key`.

На третьем шаге,
для выработки ключа, который будет использован абонентом с идентификатором ``IDa`` для связи
с абонентом, имеющим идентификатор ``IDb``, необходимо выполнить следующую команду,
явно указав имя алгоритма генерации ключей: `blom-pairwise`::

  aktool k -na blom-pairwise --key IDa.key --id IDb -o pairwise-ab.plain --target undefined

Значение опции :option:`--target` = ``undefined`` говорит о том, что выработанный ключ парной связи
будет сохранен в файле `pairwise-ab.plain` в незашифрованом виде.
Тот же ключ может быть выработан и сохранен в формате контейнера библиотеки следующим образом::

  aktool k -na blom-pairwise --key IDa.key --id IDb -o pairwise-ab.key \\
     --target kuznechik --to pem --label "used for testing purpose"

В этом случае, будет сформирован полноценный контейнер, содержащий мета-информацию
о ключе парной связи. Полученный файл может быть просмотрен, например, с помощью программы `cat`
и будет иметь следующий вид::

  -----BEGIN ENCRYPTED SYMMETRIC KEY-----
  MIIBOQYJKoUDAjQBfwEBMEkGCSqFAwI0AX8CATA8BggqhQMHAQEFAjAwBggqhQMH
  AQEEAgQgAHB+xvFnuFDcr1hjTVoOzg9mrjHog+W2YMkA2nuFqiQCAgfQMIHgBgkq
  hQMCNAF/AwEwgdIGCCqFAwcBAQUCBCCvdnxc1dJHhBjMc9fJCRAheXilh54enght
  QJrU2UlDEwwYdXNlZCBmb3IgdGVzdGluZyBwdXJwb3NlMCgCAQACAyAAADAeFw0y
  MDEyMTkyMjU3NTdaFw0yMTEyMTkyMjU3NTdaMGACAQECAQAEWGA2LJdbqSbk99Wu
  vjPwoBcA/PmKb1hI8cIj9GwbbZljdGkDUvjwO1DgnfAsc7u/Fkumtvy/i/ejQEu/
  o2Mg5v5P8bJwA0SCk+XRLluRmNYVsAYS8egjFXM=
  -----END ENCRYPTED SYMMETRIC KEY-----

Добавим, что следующая последовательность команд может быть использована
абонентом с идентификатором ``IDb`` для получения ключа парной связи с абонентом,
связанным с идентификатором ``IDa``::

  aktool k -na blom-user --key master.key -o IDb.key --id IDb
  aktool k -na blom-pairwise --key IDb.key --id IDa -o pairwise-ba.plain --target undefined

В результате для абонента с идентификатором ``IDb`` будет получен ключ парной связи `pairwise-ba.plain`
который, как легко проверить с помощью утилиты `xxd`, побайтно совпадает с выработанным ранее для абонента
с идентификатором ``IDa`` ключом `pairwise-ab.plain`.::

  xxd -g1 pairwise-ab.plain
  00000000: e2 fd af 33 30 55 22 b3 45 fd 2f 06 2b 91 45 50  ...30U".E./.+.EP
  00000010: f5 70 a6 0d 3f 78 f7 0d 9e c4 41 b2 7b 5b f1 6b  .p..?x....A.{[.k

  xxd -g1 pairwise-ba.plain
  00000000: e2 fd af 33 30 55 22 b3 45 fd 2f 06 2b 91 45 50  ...30U".E./.+.EP
  00000010: f5 70 a6 0d 3f 78 f7 0d 9e c4 41 b2 7b 5b f1 6b  .p..?x....A.{[.k

Реализация схемы Блома соотвествует рекомендациям
`Р 1323565.1.028-2019 <https://tc26.ru/standarts/rekomendatsii-po-standartizatsii/r-1323565-1-028-2019-informatsionnaya-tekhnologiya-kriptograficheskaya-zashchita-informatsii-kriptograficheskie-mekhanizmy-zashchishchennogo-vzaimodeystviya-kontrolnykh-i-izmeritelnykh-ustroystv.html>`__,
см. приложение Б.


Контроль целостности
--------------------

Команда `icode` (короткая форма `i`) позволяет вычислять контрольные суммы или имитовставки
для одного или нескольких файлов.

Для вычисления контрольных сумм могут быть использованы любые реализованные в библиотеке алгоритмы хеширования (бесключевого сжатия).
Для вычисления имитовставки необходимо использовать секретный ключ.
Данный ключ должен быть предварительно создан пользователем с использованием команды `key`.

В настоящее время для вычисления имитовставки могут быть использованы следующие алгоритмы:

   * `cmac` (ГОСТ Р 34.13-2015),  `hmac` (Р 50.1.113-2016) и `nmac` (1323565.1.022-2018).

Поскольку некоторые алгоритмы вычисления имитовставки накладывают
ограничения на объем информации, обрабатываемой на одном ключе, то для таких алгоритмов вычисление имитоставки от очень больших
файлов может приводить к ошибке. Если Вам необходимо вычислять
имитовставки файлов с произвольной, сколь угодно большой длиной, то
используйте следующие алгоритмы: `hmac-streebog256`, `hmac-streebog512`.

Опции команды icode
~~~~~~~~~~~~~~~~~~~

.. option:: -a, --algorithm=метод

Опция позволяет указать метод вычисления контрольной суммы (алгоритма бесключевого хеширования).
В качестве параметра опции может выступать имя алгоритма, например `streebog512`, или его идентификатор.
В случае, когда опция не определена, для вычисления контрольной суммы
используется бесключевая функция хеширования `streebog256`.
В случае выработки имитовставки данная опция может быть опущена.

.. option:: -c, --check=файл

Опция позволяет проверить контрольные суммы или имитовставки для
одного или нескольких файлов. Данные суммы должны быть вычислены
заранее и сохранены в указанном `файле`. Если при проверке используется
алгоритм, отличный от установленного по-умолчанию, необходимо указать
его имя или идентификатор (для алгоритмов хеширования), а также, при необходимости,
используемый секретный ключ.

.. option:: --dont-show-stat

Опция запрещает вывод в консоль статистической информации об общем
количестве проверенных файлов, количестве успешных или неуспешных
проверок и т.п. Используется только совместно с опцией :option:`--check`.

.. option:: --ignore-errors

Опция запрещает останавливать процесс проверки контрольных сумм или
имитовставок в случае возникновения ошибок доступа или чтения
файлов, отсутствия файлов, содержащихся в списке и т.п.
Используется только совместно с опцией :option:`--check`.

.. option:: --inpass=строка

Опция позволяет указать пароль доступа к считываемому секретному ключу в командной строке.
Использование данной опции может привести к компрометации ключевой информации.

.. option:: --inpass-hex=строка

Опция позволяет указать пароль доступа к считываемому секретному ключу в командной строке
в виде шестнадцатеричной последовательности.
Использование данной опции может привести к компрометации ключевой информации.

.. option:: --key=файл

Опция позволяет указать имя файла, содержащего используемый секретный ключ
алгоритма выработки имитовставки.

.. option:: -m, --mode=режим

Опция позволяет уточнить алгоритм вычисления имитовставки (`cmac`, `omac-acpkm` и т.п.),
реализуемый с использованием определяемого секретным ключом алгоритма блочного шифрования.
При вычислении контрольных сумм, а также при использовании алгоритмов семейства `hmac`,
данная опция не применяется.

.. option:: --no-derive

По-умолчанию, для вычисления имитовставки вырабатывается производный ключ,
зависящий от указанного опцией :option::`--key` исходного ключа и имени имитозащищаемого файла. Использование данной опции
приводит к запрету вычисления производного ключа и вычислению имитовставки на исходном ключе.

.. option:: -o, --output=файл

Опция определяет имя файла, в который записываются вычисленные
значения контрольных сумм или имитовставок. Данный файл может быть
указан в качестве параметра опции :option:`--check`.

.. option:: -p, --pattern=строка

Опция указывает шаблон (маску) поиска файлов, к которым применяется процедура
вычисления контрольной суммы или имитовставки.

.. option:: -r, --recursive

Опция указывает, что при вычислении контрольных сумм или
имитовставок, должна выполняться рекурсивная процедура обхода
текущего и всех вложенных каталогов. Опция имеет смысл только в том
случае, когда в аргументах вызова утилиты указано имя каталога.

.. option:: --reverse-order

Опция указывает, что все выводимые и вводимые последовательности
октетов, должны обрабатываться в обратном порядке. Использование
данной опции целесообразно для вывода результатов в `big endian`
порядке следования октетов. По-умолчанию, используется `litte-endian` порядок.

.. option:: --seed=строка

При генерации производных ключей используется криптографическая функция, инициализируемая двумя значениями - именем файла и
заданной `строкой`. В случае, если данная опция не указана, то используется определяемое утилитой
фиксированное значение.

.. option:: --tag

Опция указывает, что значения контрольных сумм или имитовставок
должны выводиться в формате, принятом в операционных системах
семейства BSD. В таком формате указывается не только имя файла и его
контрольная сумма или имитовставка, но и алгоритм, с помощью которого данная сумма
была посчитана.

Примеры использования команды icode
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Приведимый ниже вызов утилиты позволяет вычислить контрольную сумму файла
`file.txt` с помощью установленного по умолчанию алгоритма `streebog256`
и помещает результат вычислений в файл `result.txt`.::

  aktool i file.txt -o result.txt

Следующая последовательность вызовов позволяет
создать секретный ключ блочного алгоритма шифрования "Кузнечик",
а после, вычислить имитовставки всех файлов,
удовлетворяющих шаблону ``*.t??`` (файлы, имеющие расширение из трех
символов, начинающееся с символа `t`) в текущем каталоге (на это указывает
символ `.`), а также во всех доступных вложенных каталогах. Для
вычисления кода целостности используется алгоритм ГОСТ Р 34.13-2015.::

  aktool k -nt kuznechik -o kuznechik.key
  aktool i -rp "*.t??" --key kuznechik.key -m cmac-kuznechik .

Следующий вызов позволяет проверить контрольные суммы, содержащиеся в
выработанном ранее файле `result.txt`.::

  aktool i -c result.txt

В состав исходных текстов библиотеки входит набор тестовых скриптов
(каталог `scripts`), содержащий большое количество примеров использования утилиты `aktool`
для выработки и проверки контрольных сумм и кодов аутентификации.


Совместимость с другими программными средствами
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Известны две общедоступные утилиты, позволяющие вычислять контрольные
суммы с помощью отечественных алгоритмов хеширования. Этими утилитами
являются:

   * `gost12sum <https://github.com/gost-engine/engine>`__, которая входит в состав дополнительного модуля (engine) для хорошо известной программы `openssl`,
   * `rhash <https://github.com/rhash/RHash>`__.

Следующая последовательность команд позволяет продемонстрировать
эквивалентность работы всех трех утилит для алгоритма хеширования `streebog256`::

  echo -n hello > test.file
  aktool i test.file
  3fb0700a41ce6e41413ba764f98bf2135ba6ded516bea2fae8429cc5bdd46d6d test.file

  rhash -G test.file
  3fb0700a41ce6e41413ba764f98bf2135ba6ded516bea2fae8429cc5bdd46d6d test.file

  gost12sum test.file
  3fb0700a41ce6e41413ba764f98bf2135ba6ded516bea2fae8429cc5bdd46d6d test.file

Аналогично, для алгоритма хеширования `streebog512`, запуск следующих
команд также позволит получить одинаковое значение хэш-кода размером 512 бит::

  gost12sum -l test.file
  rhash --gost12-512 test.file
  aktool i -a streebog512 test.file

Программа `openssl` также может вычислять контрольные суммы.
Например, следующий вызов позволит получить тот же результат, что и ранее,
но в другом формате::

  openssl dgst -md_gost12_256 test.file > result.txt
  cat result
  md_gost12_256(test.file)=
       3fb0700a41ce6e41413ba764f98bf2135ba6ded516bea2fae8429cc5bdd46d6d

Утилита `aktool` может не только вырабатывать контрольные суммы в
таком же формате::

  aktool i --tag test.file
  streebog256 (test.file) =
       3fb0700a41ce6e41413ba764f98bf2135ba6ded516bea2fae8429cc5bdd46d6d

но и проверять файлы, подготовленные программой `openssl`, используя
единый синтаксис командной строки::

   aktool i -c result.txt --dont-show-stat


При имитозащите данных утилита `aktool` совместима с программой `openssl`
только при использовании явно заданных секретных ключей. Следующие вызовы применяют
для вычисления имитовставки функцию `hmac-streebog256` и позволяют
получить одинаковый результат::

  openssl dgst -md_gost12_256 -mac hmac -macopt hexkey:acabdcab0137 test.file
  HMAC-md_gost12_256(test.file)=
       31d56cc082c4cd57955119f4cde662b4554f867fcc08ee4d59ba32d0e604180d

  aktool i -a hmac-streebog256 --hexkey acabdcab0137 --tag --no-derive test.file
  hmac-streebog256 (test.file) =
       31d56cc082c4cd57955119f4cde662b4554f867fcc08ee4d59ba32d0e604180d

Отметим, что в данном случае секретный ключ, используемый для вычисления
имитовставки, задается явно, в виде последовательности шестнадцатеричных
символов. Максимальная длина последовательности не должна превышать 64
октета (128 шестнадцатеричных символа). Для последовательностей меньшей
длины старшие октеты заполняются нулями. Аналогичная совместимость
поддерживается при использовании функции `hmac-streebog512`.


Разбор данных в формате ASN.1
-----------------------------

Команда `asn1parse` (короткая форма `a`) позволяет декодировать и выводить в консоль данные,
закодированные в формате ASN.1 дерева. В настоящее время
поддерживается разбор чистых `der`-последовательностей, а также
`der`-последовательностей, закодированных в кодировке `base64`
(формат данных, который принято обозначать символом `pem`).


Опции команды asn1parse
~~~~~~~~~~~~~~~~~~~~~~~

.. option:: --convert=файл

Опция позволяет выполнить конвертацию ASN.1 данных между поддерживаемыми форматами,
т.е. перевести данные из `der`-формата в `pem`-формат и наоборот.
Преобразование, изменение или удаление данных из ASN.1 дерева при конвертации не производится.

.. option:: --join

Призрачная опция

.. option:: --split=файл

Опция позволяет разделить ASN.1 дерево на одну или несколько ветвей первого уровня.
После разделения каждая ветвь образует новое ASN.1 дерево и помещается в отдельный файл.
Опция может применяться для разделения коллекций сертификатов открытых ключей на
отдельные файлы.

.. option:: -o, --output=файл

Опция позволяет в явном виде определить
имя файла в который будут помещены конверированные или объединенные данные.
Данную опцию имеет смысл использовать совместно с опциями :option:`--convert` и :option:`--join`.

.. option:: --to=[ der, pem ]

Опция в явном виде указывает в каком формате должны быть сохранены данные.

.. option:: --pem=тип

Опция в явном виде позволяет определить заголовок строки
в `pem`-файле, определяющий тип содержащихся далее данных.
Данную опцию имеет смысл использовать совместно с указанием опции :option:`--to` = ``pem``.
При значении :option:`--to` = ``der`` значение опции игнорируется.

Примеры использования
~~~~~~~~~~~~~~~~~~~~~

Рассмотрим запрос на создание сертифката открытого ключа,
записанный в pem кодировке в файле `request_edw.pem`. Данный запрос
содержится в качестве примера в рекомендациях Р 1323565.1.023-2018, раздел А.2.2.1::

  -----BEGIN CERTIFICATE-----
  MIHKMHkCAQAwEjEQMA4GA1UEAxMHRXhhbXBsZTBeMBcGCCqFAwcBAQEBMAsGCSqF
  AwcBAgEBAQNDAARAdCeV1L7ohN3yhQ/sA+o/rxhE4B2dpgtkUJOlXibfw5l49ZbP
  TU0MbPHRiUPZRJPRa57AoW1RLS4SfMRpGmMY4qAAMAoGCCqFAwcBAQMCA0EAG9wq
  Exdnm2YjL2PqFv98ZMyqua2FX8bhgJFmHbedSBIdDh2lvjR8bxtSVseurCAK1krH
  em9bOg4Jcxjnrm7naQ==
  -----END CERTIFICATE-----

Декодирование данного файла может быть выполнено с помощью следующего вызова::

  aktool a request_edw.pem

В результате декодирования в консоль должна быть выведена следующая
иерархическая структура::

   SEQUENCE
           ├SEQUENCE
           │        ├INTEGER 0x0
           │        ├SEQUENCE
           │        │        └SET
           │        │            └SEQUENCE
           │        │                     ├OBJECT IDENTIFIER 2.5.4.3
           │        │                     └PRINTABLE STRING Example
           │        ├SEQUENCE
           │        │        ├SEQUENCE
           │        │        │        ├OBJECT IDENTIFIER 1.2.643.7.1.1.1.1
           │        │        │        └SEQUENCE
           │        │        │                 └OBJECT IDENTIFIER 1.2.643.7.1.2.1.1.1
           │        │        └BIT STRING
           │        │           04 40 74 27 95 D4 BE E8 84 DD F2 85 0F EC 03 EA
           │        │           3F AF 18 44 E0 1D 9D A6 0B 64 50 93 A5 5E 26 DF
           │        │           C3 99 78 F5 96 CF 4D 4D 0C 6C F1 D1 89 43 D9 44
           │        │           93 D1 6B 9E C0 A1 6D 51 2D 2E 12 7C C4 69 1A 63
           │        │           18 E2
           │        └[0]
           │             (null)
           ├SEQUENCE
           │        └OBJECT IDENTIFIER 1.2.643.7.1.1.3.2
           └BIT STRING
              1B DC 2A 13 17 67 9B 66 23 2F 63 EA 16 FF 7C 64
              CC AA B9 AD 85 5F C6 E1 80 91 66 1D B7 9D 48 12
              1D 0E 1D A5 BE 34 7C 6F 1B 52 56 C7 AE AC 20 0A
              D6 4A C7 7A 6F 5B 3A 0E 09 73 18 E7 AE 6E E7 69

Следующий вызов демонстрирует
пример конвертирования ASN.1 дерева, сохраненного в виде
`der`-последовательности, в формат `pem`::

  aktool a --convert request_edw.p10 --to pem --pem request -o request_edw.pem

Следующий вызов иллюстрирует, как можно разделить коллекцию сертификатов
`ca-bundle.crt` на отдельные файлы::

  aktool a --split ca-bundle.crt --to pem --pem certificate


Вывод служебной и вспомогательной информации
---------------------------------------------

Команда `show` (короткая форма `s`) позволяет получить информацию о доступных
преобразованиях, параметрах криптографических ключей, значениях технических и
криптографических характеристик, а также параметрах библиотеки по-умолчанию.

Опции команды show
~~~~~~~~~~~~~~~~~~

.. option:: --curve=имя

Опция позволяет вывести в консоль явные значения параметров эллиптической кривой с заданным именем
или идентификатором.

.. option:: --engines

Опция позволяет вывести список всех типов криптографических
механизмов, которые могут быть использованы в приложениях библиотеки `libakrypt`.
К таким типам, например, относятся блочные шифры или алгоритмы выработки имитовставки.

.. option:: --oid=строка

Опция принимает в качестве параметра произвольную строку символов
и выводит все доступные
криптографические механизмы, в именах или идентификаторах которых
содержится указанная строка.

.. option:: --oids

Опция позволяет вывести список всех доступных криптографических
механизмов. Каждый механизм идентифицируется свои именем, которое
используется для его указания пользователем и/или
последовательностью чисел, разделенных точками. Последняя
последовательность называется ``Object IDentifier`` (OID) и используется
при автоматизированной обработке данных.

.. option:: --options

Опция выводит перечень всех криптографических параметров библиотеки,
а также их значений. К указанным параметрам относятся, например,
число блоков информации, которые могут быть зашифрованы на одном
ключе, или число итераций криптографической функции `PBKDF2`,
используемой для развертки ключа из пароля. Значения параметров
содержатся в файле `libakrypt.conf`, расположенном либо в
системном каталоге (по-умолчанию, это `/etc`),
либо в домашнем каталоге пользователя (`/${HOME}/.config/libakrypt`).

.. option:: --modes

Опция позволяет вывести список всех режимов криптографических
преобразований, которыми могут быть охарактеризованы
криптографические преобразования. При этом одному типу криптографического
механизма может соответствовать несколько режимов. Например, функция
хеширования имеет режим `algorithm`, а ее параметры `kbox params`.

.. option:: --without-caption

Опция запрещает печать заголовка, расшифровывающего названия
выводимых параметров и их значений.

Примеры использования
~~~~~~~~~~~~~~~~~~~~~

Наиболее употребимым вариантом вызова команды `show` является вызов::

  aktool s --oids

В результате данного вызова будет выведена информация
о всех доступных библиотеке `libakrypt` криптографических преобразованиях.
Например, среди прочих, будет выведена  информация об алгоритме
блочного шифрования Кузнечик, см. ГОСТ Р 34.12-2015::

   N  oid                 name(s)          engine            mode
  --------------------------------------------------------------------------
  10  1.2.643.7.1.1.5.2   kuznechik        block cipher      algorithm
                          kuznyechik
                          grasshopper

В данной таблице указаны:

   * порядковый номер криптографического механизма,
   * идентификатор (последовательность цифр, разделенных точками),
   * перечень имен, с помощью которых пользователь может именовать криптографический механизм,
   * тип криптографического механизма,
   * режим использования.

Выборочный поиск идентификаторов можно осуществить с помощью опции :option:`--oid` (без `s` на конце). Например,
следующий вызов позволяет найти все идентификаторы, имена которых
регламентированы Техническим комитетом "Криптографическая защита информации" (ТК26)::

  aktool s --oid tc26

Получить параметры эллиптической кривой можно с помощью следующего вызова::

  aktool s --curve axeln0

После чего, в консоль будет выведена следующая информация::

  curve: id-axel-gost-3410-2012-256-paramSetN0
         axeln0
  oid:   1.2.643.2.52.1.12.1.1
  forms:
     short Weierstrass form:   y^2 = x^3 + ax + b (mod p)
  parameters:
     a =  0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd2158
     b =  0x42dfde56dd26bb76eba94ce9565e562bed1fb994675632a264afef327aa4e5ff
     p =  0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd215b
     q =  0xffffffffffffffffffffffffffffffff2c1b759991830c6b5dcc785b195c4edb
     c =  0x01 [cofactor]
  point:
    px =  0x0000000000000000000000000000000000000000000000000000000000000002
    py =  0x011e47b6e40dc7f783b9f4fc84d085884b9b88ca9ec7da8c5567c9d87f68a17f

Перечень всех известных библиотеке идентификаторов эллиптических кривых
может быть получен с помощью следующего вызова::

  aktool s --oid curve


Тестирование криптографических алгоритмов
-----------------------------------------

Команда `test` позволяет провести тестированние
корректности и скорости реализации криптографических алгоритмов.

Опции команды test
~~~~~~~~~~~~~~~~~~

.. option:: --crypto

Опция запускает процесс тестирования
всех реализованных в библиотеке `libakrypt`
криптографических преобразований. В ходе тестирования
проверяется совпадение вычисляемых значений со значениями, приведенными в различных
регламетирующих документах (см., далее, раздел "Стандарты").
В ряде случае проверяется
совпадение результатов, полученных при помощи нескольких доступных реализаций.

.. option:: --list-engines

Опция выводит список всех доступных для тестирования криптографических механизмов.

.. option:: --list-modes

Опция выводит список всех доступных для тестирования режимов криптографических механизмов.

.. option:: -e, --speed-by-engine=имя

Опция позволяет выполнить тест скорости реализации всех преобразований,
относящихся к указанному криптографическому механизму.
Список всех доступных механизмов может быть получен с использованием опции :option:`--list-engines`.

.. option:: -m, --speed-by-mode=имя

Опция позволяет выполнить тест скорости реализации всех криптографических механизмов
с заданным режимом, например, всех доступных блочных шифров в режиме гаммирования.
Список всех доступных режимов может быть получен с использованием опции :option:`--list-modes`.

.. option:: -n, --speed-by-name=имя

Опция позволяет выполнить тест скорости реализации всех криптографических алгоритмов,
в имени которых содержится заданная строка символов.

.. option:: --min-length

Опция устанавливает минимальную длину данных (в мегабайтах), используемую для тестирования
криптографических механизмов шифрования и имитозащиты.
Значение по умолчанию: 16МБ.

.. option:: --max-length

Опция устанавливает максимальную длину данных (в мегабайтах), используемую для тестирования
криптографических механизмов шифрования и имитозащиты.
Значение по умолчанию: 128МБ.

.. option:: --no-large-arrays

Опция отменяет тестирование больших объемов данных для криптографических механизмов
шифрования и имитозащиты.

.. option:: --no-packets

Опция отменяет тестирование коротких фрагметов данных (пакетного режима тестирования)
для криптографических механизмов шифрования и имитозащиты.


Примеры использования
~~~~~~~~~~~~~~~~~~~~~

Для запуска полного теста, с выводом информации об ошибках и выполняемях событиях в стандартный поток вывода ошибок (stderr),
достаточно выполнить следующую команду::

  aktool test --crypto --audit 2 --audit-file stderr

Для тестирования скорости работы могут быть использованы следующие команды::

  aktool t -n magma --verbose
  aktool t -e hmac
  aktool t -m aead
  aktool t -n sign

Использование опции :option:`--verbose` позволяет получить дополнительную информацию
о процессе измерения времени выполнения тестов.


Опции, общие для всех команд
----------------------------

Утилита содерджит ряд специальных опций, которые могут применяться со всеми доступными командами.

.. option:: --audit=[ 0, 1, 2 ]

Опция позволяет задать уровень вывода сообщений работы программы
(в виде целого неотрицательного числа):

    * уровень 0 разрешает вывод только сообщений об ошибках,
    * уровень 1 определяет вывод минимального набора сообщений,
    * уровень 2 позволяет вывести дополнительные сведения о выполняющихся криптографических преобразованиях.

.. option:: --audit-file=файл

Опция позволяет определить файл, в который будут помещаться сообщения о процессе работы программы
и ошибках её выполнения. В случае, если аргумент опции принимает значение `stderr`,
то используется системный канал вывода ошибок.

.. option:: --confirm

Удаление файлов без их подтверждения пользователем (может привести к безвозвратной потере полезных данных).

.. option:: --dont-use-colors

Для акцентирования внимания пользователя утилита использует цветовое выделение при
выводе некоторых данных. К таким данным относятся коды ошибок, сообщения об автоматическом
декодировании ASN.1 деревьев и т.п. Данная опция запрещает цветовое выделения.

.. option:: -h, --help

Вывод справки о доступных опциях заданной команды.

.. option:: --hex-input

Опция указывает, что все вводимые с консоли пароли и идентификаторы должны интерпретироваться
как последовательности шестнадцатеричных символов.

.. option:: --openssl-style

Опция позволяет использовать нестандартизированные форматы представления данных
для некоторых криптографических алгоритмов, аналогично тому,
как они реализованы в `gost-engine <https://github.com/gost-engine/engine>`__ библиотеки `openssl`.

.. option:: --quiet

В случае использования опции программа не выводит ни каких сообщений. Результат ее работы
может быть получен с помощью кода возврата.

.. option:: --verbose

Опция позволяет вывести в консоль дополнительные сведения о выполняемых операциях.
Также опция расширяет перечень сообщений, выводимых с помощью установленной системы аудита.

Примеры использования
~~~~~~~~~~~~~~~~~~~~~

Следующий вызов содержит
пример перенаправления вывода утилиты `aktool` с запрещением использования цвета
на вход программы просмотра `less` (запрет использования цвета убирает управляющие команды,
которые не могут быть обработаны утилитой просмотра)::

  aktool a 0408435EB90E5C8796A160E69E4BFAC453435D1D.cer --dont-use-colors | less

Запуск теста криптографических алгоритмов с максимальным аудитом криптографических событий
и выводом сообщений в стандартный канал вывода ошибок::

  aktool test --crypto --audit 2 --audit-file stderr


Стандарты
---------

Реализованные утилитой `aktool` криптографические преобразования и форматы данных
соотвествуют следующим стандартам Российской Федерации и рекомендациям по стандартизации
Технического комитета РФ "`Криптографическая защита информации <https://tc26.ru/standarts/>`__".

    * ГОСТ Р 34.10-2012 Процессы формирования и проверки электронной подписи,
    * ГОСТ Р 34.11-2012 Функция хэширования,
    * ГОСТ Р 34.12-2015 Блочные шифры,
    * ГОСТ Р 34.13-2015 Режимы работы блочных шифров.

    * Р 50.1.113-2016 Криптографические алгоритмы, сопутствующие применению алгоритмов электронной цифровой подписи и функции хэширования,
    * Р 1323565.1.012-2017 Принципы разработки и модернизации шифровальных (криптографических) средств защиты информации,
    * Р 1323565.1.017-2018 Криптографические алгоритмы, сопутствующие применению алгоритмов блочного шифрования,
    * Р 1323565.1.022-2018 Функции выработки производного ключа,
    * Р 1323565.1.023-2018 Использование алгоритмов ГОСТ Р 34.10-2012, ГОСТ Р 34.11-2012 в сертификате, списке аннулированных сертификатов (CRL) и запросе на сертификат PKCS #10 инфраструктуры открытых ключей X.509,
    * Р 1323565.1.024–2019 Параметры эллиптических кривых для криптографических алгоритмов и протоколов,
    * Р 1323565.1.026–2019 Режимы работы блочных шифров, реализующие аутентифицированное шифрование,
    * Р 1323565.1.028–2019 Криптографические механизмы защищенного взаимодействия контрольных и измерительных устройств.
    * Р 1323565.1.040-2022 Парольная защита ключевой информации (взамен Р 50.1.111-2016),


Также реализованы алгоритмы и форматы данных, регламентированные зарубежными рекомендациями.

    * IEEE 1619-2007 IEEE Standard for Cryptographic Protection of Data on Block-Oriented Storage Devices,
    * RFC 5652. Cryptographic Message Syntax (CMS).
